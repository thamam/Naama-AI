/**
 * Hebrew Rhyming Activity Prompt Template
 * Phase 2.5: Focus on Hebrew CV syllable structure and phonetic similarity
 */

export const generateRhymingPrompt = (params) => {
  const {
    ageGroup,
    itemCount,
    theme,
    suggestedVocabulary = [],
    nikudLevel = 'full',
    language = 'he'
  } = params;

  const ageGuidelines = {
    '2-3': '3-4 זוגות חרוזים פשוטים, הברה אחת או שתיים, דמיון צלילי ברור מאוד',
    '3-4': '5-6 זוגות/שלשות חרוזים, מילים פשוטות עד בינוניות, חרוזים מובהקים',
    '4-6': '6-8 זוגות/שלשות חרוזים, מילים מגוונות, יכול לכלול חרוזים לא מושלמים'
  };

  const rhymingGuidance = `
**עקרונות חריזה בעברית:**
- התמקד במבנה הברות CV (עיצור-תנועה) האופייני לעברית
- חרוזים מושלמים: התאמה מלאה של התנועה והעיצור האחרון (דג-חג, כלב-לב)
- חרוזים חלקיים: התאמה של התנועה האחרונה בלבד (שמש-גשם)
- שקלול דמיון פונטי גם כאשר הכתיב שונה
- שים לב להבדלים בין עיצורים זהים עם דגש שונה (ב/ב, כ/כ, פ/פ)
`;

  let vocabularySuggestions = '';
  if (suggestedVocabulary.length > 0) {
    vocabularySuggestions = `
**מילים מומלצות מבנק המילים:**
${suggestedVocabulary.map(v => `- ${v.word}`).join('\n')}

אלה מילים מאומתות המתאימות לגיל ${ageGroup}.
`;
  }

  return `אתה קלינאית תקשורת מומחית המתמחה בעברית, יוצרת פעילויות מודעות פונולוגית לילדים בגילאי ${ageGroup} שנים.

צור פעילות חרוזים בעברית המתמקדת בזיהוי וייצור מילים מחורזות.

**דרישות הפעילות:**
- התאמה לגיל: ${ageGuidelines[ageGroup]}
- מספר זוגות/שלשות חרוזים: ${itemCount || 'מתאים לגיל'}
${theme ? `- נושא: ${theme}` : ''}
- המילים חייבות להיות מוכרות לילדים בגיל זה
- החרוזים חייבים להיות דמיון צלילי אמיתי, לא רק כתיבתי
${rhymingGuidance}

**דרישות ניקוד:**
- כלול ניקוד מלא לכל המילים כדי להדגיש את הדמיון הצלילי
- שים דגש על התנועות המחורזות
${vocabularySuggestions}

**פורמט פלט (JSON):**
החזר **אך ורק** אובייקט JSON תקין במבנה המדויק הזה:
{
  "title": "משחק חרוזים בעברית",
  "instructions": "הנחיות מפורטות לקלינאית איך לבצע את הפעילות. כלול משחקים והצעות ליישום.",
  "ageGroup": "${ageGroup}",
  "rhymingPairs": [
    {
      "words": ["מִילָה1", "מִילָה2", "מִילָה3"],
      "syllableCount": [2, 2, 2],
      "rhymeType": "perfect|partial",
      "phoneticSimilarity": מספר_בין_0_ל_100,
      "rhymingEnding": "הסיומת המשותפת (למשל: -ָג)",
      "visualCues": ["רמז חזותי למילה 1", "רמז חזותי למילה 2"],
      "difficulty": "easy|medium|hard",
      "practiceActivity": "פעילות תרגול ספציפית לזוג/שלשה זו"
    }
  ],
  "gameIdeas": [
    "רעיון משחק 1 לתרגול החרוזים",
    "רעיון משחק 2 לתרגול החרוזים"
  ],
  "tips": "טיפים כלליים להוראת מודעות לחרוזים בגיל זה",
  "progressionSuggestions": "כיצד להתקדם למילים מחורזות מורכבות יותר",
  "assessmentGuidance": "איך להעריך אם הילד שולט בזיהוי חרוזים"
}

**חשוב מאוד:**
- החזר **אך ורק** את אובייקט ה-JSON, ללא טקסט נוסף
- כל זוג/שלשה חייב להכיל מילים שמחורזות באמת (לא רק נראות דומה)
- כלול ניקוד מדויק מלא
- סדר את זוגות החרוזים מהקלים לזיהוי למעט יותר קשים
- השתמש במילים מוכרות מהחיים היומיומיים של ילדים ישראליים
- רמזים חזותיים צריכים להיות ברורים ומוכרים לילדים

זכור: הפלט חייב להיות JSON תקין בלבד, ללא markdown או טקסט נוסף.`;
};

export default generateRhymingPrompt;
