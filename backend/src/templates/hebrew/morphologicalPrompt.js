/**
 * Hebrew Morphological Pattern Activity Prompt Template
 * Phase 2.5: Root-and-pattern exercises (שורש-משקל) for Hebrew language structure
 */

export const generateMorphologicalPrompt = (params) => {
  const {
    ageGroup,
    itemCount,
    theme,
    suggestedVocabulary = [],
    nikudLevel = 'full',
    patternType = 'simple' // simple, binyan, wordFamilies
  } = params;

  const ageGuidelines = {
    '2-3': 'שורשים פשוטים מאוד, 2-3 משפחות מילים, מילים מוכרות בלבד',
    '3-4': 'שורשים פשוטים, 3-4 משפחות מילים, דגש על קשרים ברורים',
    '4-6': 'שורשים מגוונים, 4-6 משפחות מילים, יכול לכלול משקלים בסיסיים'
  };

  const morphologicalGuidance = `
**עקרונות מורפולוגיה עברית:**
- שורש = 3 עיצורים (בדרך כלל) שנושאים את המשמעות הבסיסית
- משקל = תבנית שבה מוכנסים אותיות השורש
- דוגמאות לשורשים נפוצים:
  * כ-ת-ב (כתיבה): כּוֹתֵב, כָּתַב, כְּתָב, מִכְתָּב, תַּלְמִיד
  * א-כ-ל (אכילה): אוֹכֵל, אָכַל, מַאֲכָל
  * ש-מ-ר (שמירה): שׁוֹמֵר, שָׁמַר, מִשְׁמָר, שְׁמִירָה

**התאמה לגיל:**
- גילאי 2-3: התמקדות בזיהוי מילים דומות (לא הסבר שורשים)
- גילאי 3-4: מודעות ראשונית לצלילים משותפים במילים
- גילאי 4-6: הקשר בין מילים מאותו שורש, גילוי "משפחות מילים"
`;

  let vocabularySuggestions = '';
  if (suggestedVocabulary.length > 0) {
    vocabularySuggestions = `
**מילים מומלצות מבנק המילים:**
${suggestedVocabulary.map(v => `- ${v.word} ${v.root ? `(שורש: ${v.root})` : ''}`).join('\n')}
`;
  }

  return `אתה קלינאית תקשורת ומורה לעברית מומחית, יוצרת פעילויות מודעות מורפולוגית לילדים בגילאי ${ageGroup} שנים.

צור פעילות משפחות מילים ותבניות מורפולוגיות בעברית המתאימה לרמת הגיל.

**דרישות הפעילות:**
- התאמה לגיל: ${ageGuidelines[ageGroup]}
- מספר משפחות מילים/תבניות: ${itemCount || 'מתאים לגיל'}
${theme ? `- נושא: ${theme}` : ''}
- השתמש במילים מוכרות ובשימוש יומיומי
- הדגש קשרים משמעותיים בין המילים
${morphologicalGuidance}

**דרישות ניקוד:**
- כלול ניקוד מלא כדי להדגיש את השורש והתבנית
- השתמש בצבעים או סימונים מיוחדים (בתיאור) להדגשת אותיות השורש
${vocabularySuggestions}

**פורמט פלט (JSON):**
החזר **אך ורק** אובייקט JSON תקין במבנה המדויק הזה:
{
  "title": "משפחות מילים בעברית",
  "instructions": "הנחיות מפורטות לקלינאית כיצד להציג את הקשר בין המילים באופן מתאים לגיל. כלול משחקים והצעות ליישום.",
  "ageGroup": "${ageGroup}",
  "wordFamilies": [
    {
      "root": "שורש_תלת_עיצורי (למשל: כ-ת-ב)",
      "rootMeaning": "משמעות בסיסית של השורש",
      "words": [
        {
          "word": "מִילָה בניקוד מלא",
          "meaning": "משמעות המילה",
          "pattern": "המשקל (למשל: קוֹטֵל, קָטַל)",
          "syllables": מספר_הברות,
          "partOfSpeech": "שם עצם|פועל|שם תואר",
          "example": "משפט לדוגמה עם המילה",
          "visualCue": "רמז חזותי"
        }
      ],
      "connection": "הסבר על הקשר בין המילים במשפחה, מתאים לגיל",
      "gameActivity": "משחק או פעילות לתרגול משפחת המילים הזו"
    }
  ],
  "gameIdeas": [
    "משחק התאמה: התאם מילים לפי שורש משותף",
    "משחק חיפוש: מצא עוד מילים מאותה משפחה",
    "פעילות יצירתית: צור מילים חדשות מהשורש"
  ],
  "tips": "טיפים להוראת מודעות מורפולוגית בגיל זה. זכור: לא מלמדים דקדוק פורמלי, אלא מפתחים מודעות אינטואיטיבית.",
  "progressionSuggestions": "כיצד להתקדם למשפחות מילים מורכבות יותר",
  "developmentalGoals": "מטרות התפתחותיות של הפעילות (מודעות פונולוגית, העשרת אוצר מילים, הבנת קשרי משמעות)"
}

**חשוב מאוד:**
- החזר **אך ורק** את אובייקט ה-JSON, ללא טקסט נוסף
- השתמש בשורשים נפוצים ומוכרים בעברית
- כל משפחת מילים חייבת להכיל מילים שבאמת משתייכות לאותו שורש
- כלול ניקוד מדויק מלא
- התאם את רמת ההסבר לגיל הילדים - לא דקדוק פורמלי לגילאי 2-6!
- השתמש בדוגמאות קונקרטיות ומשמעותיות מחיי הילדים
- רמזים חזותיים צריכים לסייע בהבנת המשמעות

זכור: הפלט חייב להיות JSON תקין בלבד, ללא markdown או טקסט נוסף.`;
};

export default generateMorphologicalPrompt;
